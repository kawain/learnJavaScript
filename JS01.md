# JavaScript まとめ 01

表示確認は Google Chrome が圧倒的に使われています。
デプロイ（本番配置）前には、様々なブラウザで表示確認したほうが良いです。  
最近は、webpack や Parcel を使ってファイルを束ねたりするので、その過程で Babel が動いていい感じにしてくれます。  

※webpack や Parcel は JavaScript のファイルを一つに束ねるツール。  
※Babel は JavaScript のコードを古いブラウザでも見れるように、新しい書き方から古い書き方へと変換するツール。

## 行末のセミコロン

あってもなくてもよいですが、場合によってないとダメなので、セミコロンありで記述していきます。

## JavaScriptの書く場所

HTMLファイルに直接書く場合
```
<body>
    <script>
        // ここにJavaScriptコードを書く
    </script>
</body>
```
HTMLファイル読み込んで使う場合
```
<body>

    <script src="./js/index.js"></script>
</body>
```
この場合 js/index.js のファイルにJavaScriptコードを書く  
scriptタグはbody終了タグのすぐ上に書くのが多いが、headタグ内に書く方法もある。  
scriptタグに defer属性をつけた例  
HTML パース完了後 JS ファイルを実行
```
<head>
    <script src="./js/index.js" defer></script>
</head>
```
Node.jsで実行するには、コマンドプロンプトや端末で  
`$ node index.js`  
で実行できます。  
index.js の .js は省略可能。  
この場合も index.js のファイルにJavaScriptコードを書く

## 変数宣言

```
var a = "古い書き方";

const b = "新しい書き方";
// invalid assignment to const `b'
// b = "エラーになったら let";
let c = "新しい書き方";
c = "let は再代入可能";
```

### 1つのステートメントで多くの変数を宣言できます

```
const person = "John Doe", carName = "Volvo", price = 200;
```

### 値なしで宣言された変数の値は未定義

後で使うために宣言しておく方法
```
let name;

console.log(name);//undefined

if (true) {
    name = "山田太郎";
}

console.log(name);//山田太郎
```

## 色々な出力方法

```
window.alert("Hello, 世界");
console.log("Hello, 世界");
// id="hoge"の箇所に書く
document.getElementById("hoge").innerHTML = "Hello, 世界";
document.write("Hello, 世界");
```

```
// 入力ダイアログ
const result1 = window.prompt("お名前は？");
console.log(`こんにちは、${result1}さん`);

// 確認ダイアログ
const result2 = window.confirm("よいですか？");
if (result2) {
    console.log("よいです");
} else {
    console.log("よくないです");
}
```

## 変数名のつけ方

JavaScriptは小文字で始まるキャメルケースを使用する

```
first_name, last_name, master_card, inter_city
↓
firstName, lastName, masterCard, interCity
```

## コメント

```
// 一行コメント

/*
複数行
コメント
*/
```

## 足し算

```
const x = 5 + 2 + 3.1;
console.log(x);//10.1
```

```
const x = "山田" + " " + "太郎";
console.log(x);//山田 太郎
```

```
const x = "5" + 2 + 3;
console.log(x);//523
```

```
const x = 2 + 3 + "5";
console.log(x);//55
```

## 演算子

`+, -, *, **, /, %, ++, --`

```
const x = 2 ** 3;
console.log(x);//2の3乗で8
```

```
const x = 9 % 2;
console.log(x);//9 / 2 = 4 余り 1
```

```
x += y は同じ意味 x = x + y
x -= y は同じ意味 x = x - y
x *= y は同じ意味 x = x * y
x /= y は同じ意味 x = x / y
x %= y は同じ意味 x = x % y
x **= y は同じ意味 x = x ** y
```

```
let name = "山田 ";
name += "太郎";
console.log(name);//山田 太郎
```

## 比較演算子

`==, ===, !=, !==, >, <, >=, <=, ? :`

=== 3つあるのは、(※)データタイプ(データ型、型)も比較する

```
const a = 1;
const b = "1";

if (a == b) {
    console.log("同じです");//ここが表示
} else {
    console.log("違います");
}

// === にすると
if (a === b) {
    console.log("同じです");
} else {
    console.log("違います");//ここが表示
}
```

? : は3項演算子で出てきます

```
const age = 26;
const beverage = (age >= 21) ? "ビール" : "ジュース";
console.log(beverage);// "ビール"
```

### (※)データタイプは typeof でわかる

```
const a = 1;
const b = "1";
const c = "こんにちは";
const d = false;

console.log(typeof a);//number
console.log(typeof b);//string
console.log(typeof c);//string
console.log(typeof d);//boolean
```

## 論理演算子

`&&, ||, !`

## JavaScriptは動的型付け言語

同じ変数に違うデータ型を代入できる
```
let x;
x = 5;
console.log(x);//5
x = "John";
console.log(x);//John
```
これは初心者にとっては気軽で便利なようですが、バグの原因にもなります。  
チームで開発する場合、バグを減らすためにデータ型に厳しい TypeScript が使われたりします。  
TypeScript は、コンパイルすると JavaScript になる言語です。マイクロソフト製です。

## ブール値 boolean

ブール値には、trueまたはfalseの2つの値のみを指定できます。

```
const a = true;

console.log(a);//true
console.log(!a);//false

const b = false;

console.log(a && b);//false
console.log(a || b);//true

const x = 5;
const y = 5;
const z = 6;

console.log(x == y);//true
console.log(x == z);//false
```

## 関数

同じ処理を定義し何度も使い回しができる形にしたもの

関数はデータ型のひとつなので、変数に代入したり、関数の引数として渡したり、戻り値として関数を返すことが可能

https://developer.mozilla.org/ja/docs/Web/JavaScript/Guide/Functions
```
// (1)
// 普通の関数
function myFunction1(p1, p2) {
    return p1 * p2;
}

// 関数リテラル
// function (p1, p2) {
//     return p1 * p2;
// };

// (2)
// 古いテクニックと言われる
// 即時関数
let x = (function (p1, p2) {
    return p1 * p2;
})(2, 3);
console.log(x);

// (3)
// 関数式
// 関数リテラルを変数に代入
const myFunction2 = function (p1, p2) {
    return p1 * p2;
};

// (4)
// 関数式を書くならアロー関数が今どきの書き方です
// 上をアロー関数にしたもの
const myFunction3 = (p1, p2) => {
    return p1 * p2;
};

// (5)
// 関数式
// 本体が一文である場合こう書ける
const myFunction4 = (p1, p2) => p1 * p2;

const a = myFunction1(2, 3);
const b = myFunction2(2, 3);
const c = myFunction3(2, 3);
const d = myFunction3(2, 3);
const e = myFunction4(2, 3);

console.log(a);
console.log(b);
console.log(c);
console.log(d);
console.log(e);
```

### 関数式は、ある関数を別の関数の引数として渡すときに便利

意味のない使い方ですが、引数に渡せる例
```
function myfn(f, n) {
    return f(n)
}

const f = (x) => {
    return x * 10;
}

const a = myfn(f, 10);

console.log(a);//100
```

### 関数はその関数自身を呼び出すこともできます

```
function factorial(n) {
    if (n == 0 || n == 1) {
        return 1;
    } else {
        return (n * factorial(n - 1));
    }
}

console.log(factorial(1));//6
console.log(factorial(2));//2
console.log(factorial(3));//6
console.log(factorial(4));//24
console.log(factorial(5));//120
console.log(factorial(6));//720
```

```
function loop(x) {
    if (x >= 10){
        return;
    }
    console.log(x);
    loop(x + 1); // 再帰呼出し
}
loop(0);
```

### 関数のスコープ

関数の内部で宣言された変数は、関数の外部からアクセスすることができません  
その一方、関数は自身が定義されたスコープ内で定義されているすべての変数や関数にアクセスできます

```
// 以下の変数はグローバルスコープで定義
const num1 = 20, num2 = 3, name = "Chamahk";

// この関数はグローバルスコープで定義
function multiply() {
    return num1 * num2;
}

multiply(); // 60 を返す

// 入れ子になっている関数の例
function getScore() {
    const num1 = 2, num2 = 3;

    function add() {
        return name + " scored " + (num1 + num2);
    }

    return add();
}

getScore(); // "Chamahk scored 5" を返す
```

### デフォルト引数

```
function multiply(a, b = 1) {
    return a * b;
}

console.log(multiply(5));//5
console.log(multiply(2, 5));//10
```

### 残余引数

```
function fn(...args) {
    console.log(args)
}

fn(2);//Array[2]
fn(2, 3, 4, 5, 6, 7, 8, 9);//Array(8)[2, 3, 4, 5, 6, 7, 8, 9]
```

### クロージャ

基本的な考え方
```
let a = 0;

function clos() {
    a = a + 1;
    console.log(a);
}

clos();//1
clos();//2
clos();//3
```
関数を返す関数を作成  
自身が定義された環境を保持している
```
function clos() {
    let a = 0;
    return () => {
        a = a + 1;
        console.log(a);
    }
}

const fn1 = clos();
fn1();//1
fn1();//2
fn1();//3

const fn2 = clos();
fn2();//1
fn2();//2
fn2();//3

fn1();//4
fn2();//4
```

## 便利な定義済み関数

### eval() は文字列として表された JavaScript コードを式として評価する関数

```
const moji = "2+2*5";
eval(moji);//12
```
